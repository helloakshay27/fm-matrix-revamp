import { Flag, Timer, User2 } from "lucide-react";
import { useDrag } from "react-dnd";

const TaskCard = ({ task, toggleSubCard, handleLink, iconColor = "#323232" }) => {
    const [{ isDragging }, dragRef] = useDrag(() => ({
        type: "TASK",
        item: { id: task.id, fromStatus: task.status },
        collect: (monitor) => ({
            isDragging: monitor.isDragging(),
        }),
    }));

    return (
        <div
            ref={dragRef}
            style={{ opacity: isDragging ? 0.5 : 1, cursor: "move" }}
            className="w-full h-max bg-white p-2 shadow-xl text-xs flex flex-col space-y-2 mb-2"
        >
            <p className="mb-2 truncate">
                <span className="text-blue-500">{task.id}</span> {task.title}
            </p>
            <div className="flex items-center gap-1">
                <Flag className="text-[#C72030] flex-shrink-0" size={14} />
                <span className="text-[10px] truncate">{task.milestone}</span>
            </div>
            <div className="flex items-start gap-1">
                <User2 className="text-[#C72030] flex-shrink-0" size={14} />
                <span className="text-[10px] truncate">{task.assignee}</span>
            </div>
            <div className="flex items-start gap-1">
                <Timer className="text-[#029464] flex-shrink-0" size={14} />
                <span className="text-[10px] text-[#029464] truncate">{task.time}</span>
            </div>

            <hr className="border border-gray-200 my-2" />

            <div className="flex items-center justify-between">
                <div className="flex items-center gap-1">
                    <span className="flex items-center cursor-pointer">
                        <svg
                            width="14"
                            height="14"
                            viewBox="0 0 14 14"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M11.4656 6.69064C11.5063 6.73127 11.5385 6.77952 11.5605 6.83263C11.5826 6.88575 11.5939 6.94268 11.5939 7.00017C11.5939 7.05766 11.5826 7.1146 11.5605 7.16771C11.5385 7.22082 11.5063 7.26907 11.4656 7.3097L6.97847 11.7941C6.40404 12.3684 5.62497 12.6911 4.81266 12.691C4.00034 12.691 3.22131 12.3682 2.64695 11.7938C2.07259 11.2194 1.74995 10.4403 1.75 9.62799C1.75005 8.81567 2.07279 8.03664 2.64722 7.46228L8.07551 1.95415C8.48561 1.54362 9.042 1.31281 9.62228 1.3125C10.2026 1.31219 10.7592 1.54241 11.1697 1.95251C11.5803 2.36262 11.8111 2.919 11.8114 3.49928C11.8117 4.07956 11.5815 4.6362 11.1714 5.04673L5.74199 10.5549C5.49542 10.8014 5.161 10.9399 4.8123 10.9399C4.4636 10.9399 4.12918 10.8014 3.88262 10.5549C3.63605 10.3083 3.49753 9.97387 3.49753 9.62517C3.49753 9.27647 3.63605 8.94205 3.88262 8.69548L8.43808 4.06783C8.47799 4.02526 8.52601 3.9911 8.57931 3.96736C8.63262 3.94363 8.69013 3.9308 8.74847 3.92962C8.8068 3.92845 8.86479 3.93896 8.919 3.96053C8.97322 3.9821 9.02257 4.01429 9.06416 4.05522C9.10574 4.09615 9.13872 4.14499 9.16115 4.19885C9.18358 4.25272 9.19501 4.31053 9.19477 4.36888C9.19452 4.42723 9.18261 4.48494 9.15972 4.53861C9.13684 4.59229 9.10345 4.64084 9.06152 4.68142L4.50551 9.314C4.46471 9.35447 4.43229 9.40258 4.41009 9.45557C4.38789 9.50857 4.37635 9.56542 4.37612 9.62288C4.37589 9.68034 4.38698 9.73729 4.40876 9.79046C4.43054 9.84363 4.46258 9.892 4.50304 9.93279C4.54351 9.97358 4.59162 10.006 4.64462 10.0282C4.69762 10.0504 4.75447 10.0619 4.81193 10.0622C4.86939 10.0624 4.92633 10.0513 4.97951 10.0295C5.03268 10.0078 5.08104 9.97572 5.12183 9.93525L10.5507 4.42986C10.7972 4.1838 10.936 3.84987 10.9363 3.50152C10.9367 3.15318 10.7986 2.81897 10.5526 2.5724C10.3065 2.32583 9.97258 2.18711 9.62424 2.18675C9.2759 2.18639 8.94168 2.32442 8.69512 2.57048L3.26793 8.07642C3.06461 8.27941 2.90327 8.52046 2.79312 8.7858C2.68296 9.05114 2.62615 9.33558 2.62592 9.62288C2.62569 9.91018 2.68205 10.1947 2.79179 10.4602C2.90152 10.7257 3.06248 10.9671 3.26547 11.1704C3.46846 11.3737 3.7095 11.535 3.97485 11.6452C4.24019 11.7553 4.52463 11.8121 4.81193 11.8124C5.09923 11.8126 5.38376 11.7562 5.64928 11.6465C5.9148 11.5368 6.1561 11.3758 6.35941 11.1728L10.8471 6.68845C10.9294 6.60676 11.0408 6.56109 11.1568 6.5615C11.2728 6.56191 11.3838 6.60836 11.4656 6.69064Z"
                                fill="#323232"
                            />
                        </svg>
                        1
                    </span>

                    <svg onClick={handleLink}

                        className="cursor-pointer"
                        width="14"
                        height="14"
                        viewBox="0 0 14 14"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path 
                            d="M9.05969 4.94069C9.10036 4.98132 9.13263 5.02957 9.15465 5.08268C9.17667 5.1358 9.188 5.19273 9.188 5.25022C9.188 5.30772 9.17667 5.36465 9.15465 5.41776C9.13263 5.47087 9.10036 5.51912 9.05969 5.55975L5.55969 9.05975C5.51904 9.1004 5.47078 9.13264 5.41767 9.15464C5.36456 9.17664 5.30764 9.18797 5.25016 9.18797C5.19267 9.18797 5.13575 9.17664 5.08264 9.15464C5.02953 9.13264 4.98127 9.1004 4.94062 9.05975C4.89998 9.0191 4.86773 8.97085 4.84573 8.91774C4.82374 8.86463 4.81241 8.80771 4.81241 8.75022C4.81241 8.69274 4.82374 8.63581 4.84573 8.5827C4.86773 8.52959 4.89998 8.48134 4.94062 8.44069L8.44062 4.94069C8.48126 4.90001 8.52951 4.86774 8.58262 4.84573C8.63573 4.82371 8.69266 4.81238 8.75016 4.81238C8.80765 4.81238 8.86458 4.82371 8.91769 4.84573C8.9708 4.86774 9.01905 4.90001 9.05969 4.94069ZM11.7908 2.2096C11.5064 1.92518 11.1688 1.69957 10.7972 1.54565C10.4256 1.39172 10.0274 1.3125 9.62516 1.3125C9.22296 1.3125 8.8247 1.39172 8.45311 1.54565C8.08154 1.69957 7.74391 1.92518 7.45953 2.2096L5.81562 3.85296C5.73353 3.93505 5.68741 4.04639 5.68741 4.16249C5.68741 4.27858 5.73353 4.38993 5.81562 4.47202C5.89772 4.55411 6.00906 4.60023 6.12516 4.60023C6.24125 4.60023 6.35259 4.55411 6.43469 4.47202L8.07859 2.83139C8.49033 2.4287 9.04426 2.20463 9.62017 2.2078C10.1961 2.21097 10.7475 2.44113 11.1548 2.84833C11.5621 3.25554 11.7923 3.80692 11.7956 4.38283C11.7989 4.95875 11.5749 5.51271 11.1723 5.92452L9.52781 7.56842C9.44572 7.65044 9.39957 7.76172 9.39952 7.87776C9.39947 7.99381 9.44552 8.10512 9.52754 8.18721C9.60956 8.26931 9.72083 8.31545 9.83688 8.31551C9.95292 8.31556 10.0642 8.26951 10.1463 8.18749L11.7908 6.54085C12.0752 6.25646 12.3008 5.91884 12.4547 5.54726C12.6087 5.17568 12.6879 4.77742 12.6879 4.37522C12.6879 3.97302 12.6087 3.57476 12.4547 3.20318C12.3008 2.8316 12.0752 2.49398 11.7908 2.2096ZM7.56562 9.52788L5.92172 11.1718C5.71942 11.3786 5.47809 11.5433 5.21172 11.6562C4.94535 11.7692 4.65921 11.8281 4.36989 11.8297C4.08057 11.8313 3.79381 11.7755 3.5262 11.6655C3.2586 11.5555 3.01548 11.3935 2.81091 11.1889C2.60635 10.9843 2.4444 10.7412 2.33445 10.4735C2.2245 10.2059 2.16874 9.91914 2.17038 9.62982C2.17202 9.3405 2.23105 9.05438 2.34403 8.78803C2.45701 8.52167 2.62171 8.28038 2.82859 8.07811L4.47195 6.43475C4.55405 6.35266 4.60016 6.24132 4.60016 6.12522C4.60016 6.00912 4.55405 5.89778 4.47195 5.81569C4.38986 5.7336 4.27852 5.68748 4.16242 5.68748C4.04632 5.68748 3.93498 5.7336 3.85289 5.81569L2.20953 7.4596C1.63517 8.03396 1.3125 8.81295 1.3125 9.62522C1.3125 10.4375 1.63517 11.2165 2.20953 11.7908C2.78389 12.3652 3.56289 12.6879 4.37516 12.6879C5.18742 12.6879 5.96642 12.3652 6.54078 11.7908L8.18469 10.1464C8.26671 10.0643 8.31276 9.95299 8.31271 9.83694C8.31265 9.7209 8.26651 9.60962 8.18441 9.5276C8.10232 9.44558 7.99101 9.39953 7.87496 9.39959C7.75892 9.39964 7.64764 9.44579 7.56562 9.52788Z"
                            fill={iconColor}
                        />
                    </svg>

                    <svg
                        className="cursor-pointer"
                        width="14"
                        height="14"
                        viewBox="0 0 14 14"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <g clip-path="url(#clip0_3871_6341)">
                            <path
                                d="M7.00023 3.9371C7.11626 3.9371 7.22754 3.98319 7.30958 4.06524C7.39163 4.14729 7.43773 4.25857 7.43773 4.3746V7.4371C7.43773 7.55313 7.39163 7.66441 7.30958 7.74646C7.22754 7.82851 7.11626 7.8746 7.00023 7.8746C6.88419 7.8746 6.77291 7.82851 6.69087 7.74646C6.60882 7.66441 6.56273 7.55313 6.56273 7.4371V4.3746C6.56273 4.25857 6.60882 4.14729 6.69087 4.06524C6.77291 3.98319 6.88419 3.9371 7.00023 3.9371ZM6.34398 9.40585C6.34398 9.53564 6.38246 9.66252 6.45457 9.77044C6.52668 9.87836 6.62918 9.96247 6.74909 10.0121C6.869 10.0618 7.00095 10.0748 7.12825 10.0495C7.25555 10.0242 7.37249 9.96167 7.46426 9.86989C7.55604 9.77811 7.61854 9.66118 7.64387 9.53388C7.66919 9.40658 7.65619 9.27463 7.60652 9.15471C7.55685 9.0348 7.47274 8.93231 7.36482 8.8602C7.2569 8.78809 7.13002 8.7496 7.00023 8.7496C6.82618 8.7496 6.65926 8.81874 6.53619 8.94181C6.41312 9.06488 6.34398 9.2318 6.34398 9.40585ZM13.1252 6.9996C13.1255 7.1142 13.1031 7.22773 13.0593 7.33361C13.0155 7.4395 12.9511 7.53564 12.8698 7.61647L7.6171 12.8698C7.45316 13.0327 7.23139 13.1242 7.00023 13.1242C6.76906 13.1242 6.54729 13.0327 6.38335 12.8698L1.13335 7.61647C0.97038 7.45253 0.878906 7.23076 0.878906 6.9996C0.878906 6.76844 0.97038 6.54667 1.13335 6.38272L6.38608 1.12944C6.55003 0.966474 6.7718 0.875 7.00296 0.875C7.23412 0.875 7.45589 0.966474 7.61983 1.12944L12.8726 6.38272C12.9533 6.46379 13.0172 6.56003 13.0606 6.6659C13.1039 6.77178 13.1259 6.88519 13.1252 6.9996ZM12.2502 6.9996L7.00023 1.7496L1.75022 6.9996L7.00023 12.2496L12.2502 6.9996Z"
                                fill="#FF0F00"
                            />
                        </g>
                        <defs>
                            <clipPath id="clip0_3871_6341">
                                <rect width="14" height="14" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>

                    <span
                        className="flex items-center cursor-pointer"
                        onClick={toggleSubCard}
                    >
                        <svg
                            width="14"
                            height="14"
                            viewBox="0 0 14 14"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M3.49967 5.25033H6.99967M2.33301 2.91699H4.66634M3.49967 2.91699V9.33366C3.49967 9.48837 3.56113 9.63674 3.67053 9.74614C3.77993 9.85553 3.9283 9.91699 4.08301 9.91699H6.99967M6.99967 4.66699C6.99967 4.51228 7.06113 4.36391 7.17053 4.25451C7.27993 4.14512 7.4283 4.08366 7.58301 4.08366H11.083C11.2377 4.08366 11.3861 4.14512 11.4955 4.25451C11.6049 4.36391 11.6663 4.51228 11.6663 4.66699V5.83366C11.6663 5.98837 11.6049 6.13674 11.4955 6.24614C11.3861 6.35553 11.2377 6.41699 11.083 6.41699H7.58301C7.4283 6.41699 7.27993 6.35553 7.17053 6.24614C7.06113 6.13674 6.99967 5.98837 6.99967 5.83366V4.66699ZM6.99967 9.33366C6.99967 9.17895 7.06113 9.03058 7.17053 8.92118C7.27993 8.81178 7.4283 8.75033 7.58301 8.75033H11.083C11.2377 8.75033 11.3861 8.81178 11.4955 8.92118C11.6049 9.03058 11.6663 9.17895 11.6663 9.33366V10.5003C11.6663 10.655 11.6049 10.8034 11.4955 10.9128C11.3861 11.0222 11.2377 11.0837 11.083 11.0837H7.58301C7.4283 11.0837 7.27993 11.0222 7.17053 10.9128C7.06113 10.8034 6.99967 10.655 6.99967 10.5003V9.33366Z"
                                stroke="#323232"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </svg>
                        {task.subtasks.length}
                    </span>

                    <svg
                        className="cursor-pointer"
                        width="14"
                        height="14"
                        viewBox="0 0 14 14"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <g clip-path="url(#clip0_3871_6350)">
                            <path
                                d="M12.8952 7.4394L7.61411 2.15829C7.54381 2.08924 7.46054 2.0348 7.3691 1.99809C7.27766 1.96138 7.17986 1.94313 7.08133 1.9444H6.26855L12.3469 7.95273L8.25189 12.0827C8.32159 12.1525 8.40434 12.2078 8.49542 12.2455C8.58651 12.2832 8.68413 12.3027 8.78272 12.3027C8.88131 12.3027 8.97894 12.2832 9.07002 12.2455C9.1611 12.2078 9.24385 12.1525 9.31355 12.0827L12.8952 8.50106C12.9649 8.43136 13.0203 8.34861 13.058 8.25753C13.0957 8.16645 13.1152 8.06882 13.1152 7.97023C13.1152 7.87164 13.0957 7.77401 13.058 7.68293C13.0203 7.59185 12.9649 7.5091 12.8952 7.4394Z"
                                fill="#323232"
                            />
                            <path
                                d="M3.03675 4.84987C3.32241 4.84987 3.55398 4.61831 3.55398 4.33265C3.55398 4.047 3.32241 3.81543 3.03675 3.81543C2.7511 3.81543 2.51953 4.047 2.51953 4.33265C2.51953 4.61831 2.7511 4.84987 3.03675 4.84987Z"
                                fill="#323232"
                            />
                            <path
                                d="M10.8033 7.45489L5.52221 2.16989C5.45287 2.09874 5.37004 2.04214 5.27855 2.00341C5.18707 1.96468 5.08878 1.9446 4.98943 1.94434H1.40388C1.20482 1.94434 1.01391 2.02341 0.873153 2.16417C0.732396 2.30492 0.65332 2.49583 0.65332 2.69489V6.28045C0.65359 6.37886 0.673312 6.47625 0.711354 6.56702C0.749396 6.65779 0.805006 6.74014 0.874987 6.80934L6.15999 12.0943C6.22969 12.1641 6.31244 12.2194 6.40352 12.2571C6.4946 12.2949 6.59223 12.3143 6.69082 12.3143C6.78941 12.3143 6.88703 12.2949 6.97812 12.2571C7.0692 12.2194 7.15195 12.1641 7.22165 12.0943L10.8033 8.51267C10.943 8.37206 11.0213 8.18194 11.0213 7.98378C11.0213 7.78562 10.943 7.5955 10.8033 7.45489ZM6.71221 11.546L1.43499 6.28045V2.72211H4.97388L10.255 7.96434L6.71221 11.546Z"
                                fill="#323232"
                            />
                        </g>
                        <defs>
                            <clipPath id="clip0_3871_6350">
                                <rect width="14" height="14" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>

                    <svg
                        className="cursor-pointer"
                        width="14"
                        height="14"
                        viewBox="0 0 14 14"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <g clip-path="url(#clip0_3871_6359)">
                            <path
                                d="M4.66699 7.87467H9.33366M4.66699 4.95801H7.00033M3.55808 11.083C2.80013 11.0083 2.23099 10.7805 1.85066 10.3993C1.16699 9.71626 1.16699 8.61609 1.16699 6.41634V6.12467C1.16699 3.92492 1.16699 2.82476 1.85066 2.14167C2.53433 1.45859 3.63391 1.45801 5.83366 1.45801H8.16699C10.3667 1.45801 11.4669 1.45801 12.15 2.14167C12.8331 2.82534 12.8337 3.92492 12.8337 6.12467V6.41634C12.8337 8.61609 12.8337 9.71626 12.15 10.3993C11.4663 11.0824 10.3667 11.083 8.16699 11.083C7.84033 11.09 7.57958 11.1151 7.32408 11.1734C6.62466 11.3344 5.97716 11.6926 5.33783 12.0041C4.42608 12.4486 3.97049 12.6708 3.68466 12.4626C3.13749 12.0554 3.67241 10.7925 3.79199 10.208"
                                stroke="#323232"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                        </g>
                        <defs>
                            <clipPath id="clip0_3871_6359">
                                <rect width="14" height="14" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                </div>
                <div className="flex items-center gap-1">
                    <span className="flex items-center gap-1 text-[8px] cursor-pointer truncate">
                        <svg
                            width="14"
                            height="14"
                            viewBox="0 0 14 14"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M12.1337 4.54779C12.7408 5.81752 12.8561 7.26713 12.4573 8.61685C12.0584 9.96656 11.1737 11.1207 9.97399 11.8565C8.77424 12.5923 7.34447 12.8576 5.96061 12.6012C4.57674 12.3448 3.3369 11.5849 2.48037 10.4682C1.62384 9.35143 1.21134 7.95697 1.32248 6.55396C1.43361 5.15095 2.06052 3.83883 3.08219 2.87085C4.10386 1.90287 5.44788 1.34765 6.85485 1.31234C8.26182 1.27703 9.63199 1.76414 10.7009 2.67966L11.9407 1.43935C12.0228 1.35726 12.1341 1.31114 12.2502 1.31114C12.3663 1.31114 12.4777 1.35726 12.5598 1.43935C12.6419 1.52144 12.688 1.63278 12.688 1.74888C12.688 1.86498 12.6419 1.97632 12.5598 2.05841L7.30976 7.30841C7.22767 7.3905 7.11632 7.43662 7.00023 7.43662C6.88413 7.43662 6.77279 7.3905 6.6907 7.30841C6.6086 7.22632 6.56248 7.11498 6.56248 6.99888C6.56248 6.88278 6.6086 6.77144 6.6907 6.68935L8.20663 5.17341C7.79579 4.9017 7.30528 4.77659 6.81449 4.81835C6.3237 4.86011 5.86137 5.06628 5.50234 5.40349C5.14331 5.74071 4.9086 6.18922 4.8362 6.67643C4.76379 7.16364 4.85794 7.66103 5.1034 8.08807C5.34886 8.51512 5.73126 8.84682 6.18869 9.02949C6.64613 9.21216 7.15183 9.23509 7.62392 9.09459C8.09602 8.95409 8.50688 8.65836 8.78999 8.2553C9.0731 7.85223 9.21189 7.36541 9.1839 6.87365C9.18067 6.81619 9.18878 6.75866 9.20778 6.70435C9.22679 6.65003 9.2563 6.59999 9.29464 6.55708C9.33298 6.51417 9.3794 6.47923 9.43124 6.45426C9.48308 6.42928 9.53934 6.41477 9.59679 6.41154C9.71282 6.40501 9.82669 6.44484 9.91336 6.52228C9.95627 6.56062 9.99121 6.60703 10.0162 6.65888C10.0412 6.71072 10.0557 6.76697 10.0589 6.82443C10.0988 7.52048 9.89998 8.2093 9.49534 8.77706C9.0907 9.34481 8.50445 9.7575 7.83348 9.94693C7.16251 10.1364 6.447 10.0912 5.80519 9.81884C5.16338 9.54651 4.63371 9.06335 4.3037 8.4492C3.9737 7.83506 3.86313 7.12669 3.99026 6.44119C4.11739 5.75569 4.47462 5.13408 5.00289 4.67911C5.53117 4.22413 6.19888 3.96303 6.89566 3.93896C7.59243 3.91488 8.27657 4.12927 8.83499 4.54669L10.0791 3.30255C9.16738 2.54557 8.0081 2.15212 6.82394 2.1978C5.63979 2.24347 4.51425 2.72503 3.66352 3.54999C2.81278 4.37496 2.29683 5.48515 2.21477 6.66734C2.1327 7.84954 2.4903 9.02037 3.21889 9.95497C3.94748 10.8896 4.99568 11.522 6.16217 11.7309C7.32866 11.9397 8.53119 11.7102 9.53878 11.0865C10.5464 10.4627 11.288 9.48872 11.6212 8.35149C11.9544 7.21426 11.8557 5.99402 11.3441 4.92513C11.294 4.82041 11.2876 4.7001 11.3263 4.59067C11.365 4.48124 11.4455 4.39165 11.5502 4.34161C11.6549 4.29158 11.7753 4.28519 11.8847 4.32385C11.9941 4.36251 12.0837 4.44307 12.1337 4.54779Z"
                                fill="#C72030"
                            />
                        </svg>
                        <span className="text-[8px] w-max">30 Nov</span>
                    </span>
                    <span className="h-5 w-5 flex items-center justify-center bg-green-600 text-white rounded-full text-[7px] font-light">
                        AT
                    </span>
                </div>
            </div>
        </div>
    );
};

export default TaskCard;
